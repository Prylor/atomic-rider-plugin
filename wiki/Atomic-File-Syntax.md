# Atomic File Syntax Reference

Complete syntax reference for `.atomic` configuration files.

## File Structure

An atomic file consists of:
1. **Header properties** (optional)
2. **Imports section** (optional)
3. **Tags section** (optional)
4. **Values section** (optional)

```atomic
# Header Properties
property: value

# Sections
imports:
    Namespace1
    Namespace2

tags:
    Tag1
    Tag2

values:
    Field1: Type1
    Field2: Type2
```

## Header Properties

### Required Properties

| Property | Type | Description | Example |
|----------|------|-------------|---------|
| `entityType` | string | Base entity type | `Entity`, `GameObject` |
| `namespace` | string | Target C# namespace | `Game.Components` |
| `className` | string | Generated class name | `EntityExtensions` |

### Optional Properties

| Property | Type | Default | Description | Example |
|----------|------|---------|-------------|---------|
| `header` | string | none | Custom file header | `"Generated by Atomic"` |
| `directory` | string | same as source | Output directory | `"Generated"`, `"../Common"` |
| `solution` | string | current | Target solution | `"MyGame.sln"` |
| `aggressiveInlining` | bool | false | Enable aggressive inlining | `true`, `false` |
| `unsafe` | bool | false | Enable unsafe code | `true`, `false` |

### Property Syntax

```atomic
# String values - quotes optional
namespace: MyGame.Components
namespace: "MyGame.Components"

# Boolean values
aggressiveInlining: true
unsafe: false

# Paths - relative or absolute
directory: Generated
directory: "../Shared/Generated"
directory: "C:/Projects/Game/Generated"
```

## Imports Section

Defines C# namespaces to import in the generated file.

### Syntax

```atomic
imports:
    System
    System.Collections.Generic
    UnityEngine
    MyGame.Core
```

### Rules
- One namespace per line
- Indentation required (spaces or tabs)
- No semicolons or quotes needed
- Duplicates are automatically filtered

## Tags Section

Defines boolean flags for entities.

### Syntax

```atomic
tags:
    Player
    Enemy
    Projectile
    Dead
    Invincible
```

### Rules
- One tag per line
- Must be valid C# identifiers
- PascalCase recommended
- Generates: `Has{Tag}Tag()`, `Add{Tag}Tag()`, `Del{Tag}Tag()`

### Generated Code Example

```csharp
// For tag "Player"
public static bool HasPlayerTag(this Entity entity);
public static void AddPlayerTag(this Entity entity);
public static void DelPlayerTag(this Entity entity);
```

## Values Section

Defines typed components for entities.

### Syntax

```atomic
values:
    Health: int
    Position: Vector3
    Name: string
    Speed: float
    IsActive: bool
    Target: Entity
    Items: List<Item>
    Data: Dictionary<string, object>
```

### Supported Types

#### Primitive Types
- `bool`, `byte`, `sbyte`
- `short`, `ushort`, `int`, `uint`, `long`, `ulong`
- `float`, `double`, `decimal`
- `char`, `string`

#### Unity Types (if imported)
- `Vector2`, `Vector3`, `Vector4`
- `Quaternion`, `Color`, `Color32`
- `Transform`, `GameObject`

#### Generic Types
```atomic
values:
    # Collections
    Items: List<Item>
    Enemies: HashSet<Entity>
    Stats: Dictionary<string, float>
    
    # Nested generics
    Groups: List<List<Entity>>
    Cache: Dictionary<int, List<Component>>
    
    # Arrays
    Path: Vector3[]
    Matrix: int[,]
    Jagged: float[][]
```

### Generated Methods

For each value, 7 methods are generated:

```csharp
// For value "Health: int"
public static int GetHealth(this Entity entity);
public static void SetHealth(this Entity entity, int value);
public static void AddHealth(this Entity entity);
public static bool HasHealth(this Entity entity);
public static void DelHealth(this Entity entity);
public static bool TryGetHealth(this Entity entity, out int value);
public static ref int RefHealth(this Entity entity); // if unsafe: true
```

## Comments

Use `#` for single-line comments:

```atomic
# This is a comment
entityType: Entity  # Inline comment

# imports:  # This section is commented out
#     System
```

## Complete Examples

### Basic Example

```atomic
entityType: GameObject
namespace: Game.Components
className: GameObjectExt

tags:
    Active

values:
    Health: int
```

### Advanced Example

```atomic
header: "Auto-generated - DO NOT EDIT"
entityType: Entity
namespace: Game.ECS.Components
className: EntityComponents
directory: "Generated/ECS"
aggressiveInlining: true
unsafe: true

imports:
    System
    System.Collections.Generic
    UnityEngine
    Game.Core
    Game.Items

tags:
    # Flags
    Player
    Enemy
    Dead
    Invincible
    
    # States
    Moving
    Attacking
    Defending

values:
    # Basic stats
    Health: int
    MaxHealth: int
    Mana: float
    MaxMana: float
    
    # Transform
    Position: Vector3
    Rotation: Quaternion
    Scale: Vector3
    
    # Physics
    Velocity: Vector3
    Acceleration: Vector3
    Mass: float
    
    # References
    Target: Entity
    Owner: Entity
    
    # Collections
    Inventory: List<Item>
    ActiveEffects: HashSet<Effect>
    Attributes: Dictionary<string, float>
    
    # Arrays
    PatrolPoints: Vector3[]
    DamageHistory: float[]
```

## Validation Rules

### Valid Identifiers
- Must start with letter or underscore
- Can contain letters, digits, underscores
- Cannot be C# keywords
- Must be unique within section

### Type Validation
- Types must exist in project or imports
- Generic types must have valid type arguments
- Array types support up to 3 dimensions

### Error Examples

```atomic
# ❌ Invalid: Missing required field
namespace: Game
className: Extensions
# Missing: entityType

# ❌ Invalid: Bad identifier
tags:
    123Invalid  # Cannot start with number
    my-tag     # Hyphens not allowed

# ❌ Invalid: Unknown type
values:
    Data: UnknownType  # Type not found

# ❌ Invalid: Duplicate names
values:
    Health: int
    Health: float  # Duplicate name
```

## Best Practices

1. **Organization**: Group related properties
2. **Naming**: Use PascalCase for tags and values
3. **Comments**: Document complex types
4. **Imports**: Only import what you need
5. **Directory**: Use consistent output structure

## IDE Features

### Auto-completion
- Press `Ctrl+Space` for suggestions
- Works for properties, types, namespaces

### Validation
- Red underlines for errors
- Yellow for warnings
- Quick fixes with `Alt+Enter`

### Navigation
- `Ctrl+Click` to go to type definition
- `Shift+F12` to find usages

### Refactoring
- `Shift+F6` to rename
- Updates all references automatically